---
title: 基因数据分析（一）
date: 2017-01-09 10:27:56
tags: 数据分析
description: 本文将初步介绍基因分析的一般流程
---

<!-- more -->

*"we only live once"*

<br/>


最近在做一个关于基于数据分析的项目，主要是针对一种罕见病找出相关的有可能的致病基因，对于基因分析，往往资料特别难找，由于不具备生物学的相关理论知识，所以即使找到了也是很难理解。具体的分析流程比较繁琐大多数人刚开始的时候一头雾水。我在做的时候也经历了这些比较痛苦的阶段，所以我想分享出我的一些经验以给有需要的人提供些帮助，减少走弯路的时间。
这篇博客我会先介绍一般的分析流程，在以后的博客中将会更加详细的介绍具体内容。
## 分析流程
首先我们要了解我们所获取的数据，这里我们的项目中所用到的是患者的全基因组数据，所以最原始的数据当然是医学人员通过基因测序工具所获取得到的，它的数据类型是FASTQ，这种文件记录了所测碱基读段和质量分数，每条读段会占4行，这种数据没有相关的理论知识是很难理解的，可以查阅相关的资料，不懂也没有太大关系，后面转化为其它格式的文件并处理（添加注释）后会一目了然。

我们得到患者的基因组数据后，就对着一堆碱基序列是没有任何意义的 ，我们还要知道他们的基因组数据每一部分都对应着什么基因，这里要使用一个叫做**BWA**的基因分析工具，它会把短序列和参考基因组对比，从而确定我们所测到的短序列在基因组上的具体位置，从而重新组装成完整的人类参考基因组，这时我们会得到一个**sam**类型的文件。由于我们是要用程序进行分析数据，所以当然希望在不影响信息量的情况下压缩数据（一个人的基因数据是非常大的，一般是3G左右），这样运算速度就会更快，这里我们使用**Samtools**软件将这些短序列按照一定顺序排列（按照染色体排列1~22,X,Y)，并进行数据格式转换，将sam文件转化为**bam**文件（一种二进制文件）。另外由于在对人进行基因测序的时候往往会进行多次测序以保证完整和正确，这样就必然会产生冗余数据以及一些额外的噪声，我们需要将这些数据清除，这里可以使用**Picard**工具实现去重功能，将冗余信息和噪声去掉。在以上任务都完成后，我们需要将患者的基因组数据和正常的基因组数据进行比对，找出变异点，这可以说是在前期最关键的一项工作了，这里可以使用**GATK**软件，它是现在用来寻找变异的主流软件，说到变异，根据不同的研究目的会划分为多种，什么单碱基变异、短插入缺失等等，还可以分为同义突变和非同义突变，像*同义突变*对于分析来说就没有很大意义了，因为这种突变并不会产生任何影响，所以在后期要进行过滤，这里我们将得到**vcf**类型的文件，这种文件相比于之前的文件就好看多了。为了进一步的用于分析，我们需要添加**注释**，比如说明该变异所在的染色体，开始位置，结束位置，参考基因，基因类型，影响程度等等，根据不同的分析目的添加不同的注释，这里可以使用**ANNOVAR**高效注释变异的工具，添加注释信息只需要添加对应的注释库就行了，十分方便，生成的**csv**文件也便于进一步的分析。以下是运行流程图：

![流程图](http://odbihfqll.bkt.clouddn.com/%E5%9F%BA%E5%9B%A0%E5%88%86%E6%9E%90%E6%B5%81%E7%A8%8B%E5%9B%BE.png)

以下是生成的vcf文件和csv注释文件截图：
*vcf file*：

![vcf file](http://odbihfqll.bkt.clouddn.com/vcf_file.png)

*csv file*:

![csv file](http://odbihfqll.bkt.clouddn.com/annovar.png)

在后面的博客中将会详细介绍文件中所包含的信息，特别是对于得到的注释文件的分析。